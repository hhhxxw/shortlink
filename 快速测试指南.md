# ğŸš€ å¿«é€Ÿæµ‹è¯•æŒ‡å—

## å½“å‰çŠ¶æ€
âœ… æœåŠ¡é—´è°ƒç”¨æˆåŠŸäº†ï¼  
âš ï¸ ä½†æ˜¯æ²¡æœ‰æ•°æ®ï¼ˆdata: nullï¼‰

---

## ğŸ“ é—®é¢˜åŸå› 
æ•°æ®åº“ä¸­ `gid='15'` çš„åˆ†ç»„ä¸‹æ²¡æœ‰çŸ­é“¾æ¥æ•°æ®ã€‚

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ æµ‹è¯•æ•°æ®

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨SQLè„šæœ¬ï¼ˆæ¨èï¼‰

#### 1. åœ¨æ•°æ®åº“å·¥å…·ä¸­æ‰§è¡Œ
æ‰“å¼€ Navicat / DataGrip / MySQL Workbenchï¼Œæ‰§è¡Œä»¥ä¸‹SQLï¼š

```sql
-- 1. å…ˆåˆ›å»ºåˆ†ç»„
INSERT INTO `t_group` (`gid`, `name`, `username`, `sort_order`, `create_time`, `update_time`, `del_flag`)
VALUES ('15', 'æµ‹è¯•åˆ†ç»„', 'admin', 0, NOW(), NOW(), 0);

-- 2. åˆ›å»ºæµ‹è¯•çŸ­é“¾æ¥
INSERT INTO `t_link` (
    `domain`, `short_uri`, `full_short_url`, `origin_url`, 
    `click_num`, `gid`, `enable_status`, `created_type`, 
    `valid_date_type`, `describe`, `create_time`, `update_time`, `del_flag`
) VALUES 
('nurl.ink', 'abc123', 'nurl.ink/abc123', 'https://www.baidu.com', 
 0, '15', 1, 0, 0, 'æµ‹è¯•çŸ­é“¾æ¥-ç™¾åº¦', NOW(), NOW(), 0),
('nurl.ink', 'xyz789', 'nurl.ink/xyz789', 'https://www.github.com', 
 10, '15', 1, 0, 0, 'æµ‹è¯•çŸ­é“¾æ¥-GitHub', NOW(), NOW(), 0),
('nurl.ink', 'test01', 'nurl.ink/test01', 'https://www.google.com', 
 5, '15', 1, 0, 0, 'æµ‹è¯•çŸ­é“¾æ¥-Google', NOW(), NOW(), 0);

-- 3. éªŒè¯æ•°æ®
SELECT * FROM t_link WHERE gid = '15' AND del_flag = 0;
```

#### 2. æˆ–è€…å¯¼å…¥SQLæ–‡ä»¶
ç›´æ¥å¯¼å…¥ `æ•°æ®åº“/åˆ›å»ºæµ‹è¯•æ•°æ®.sql` æ–‡ä»¶ã€‚

---

### æ–¹æ³•äºŒï¼šä½¿ç”¨åˆ›å»ºæ¥å£ï¼ˆæ¨èï¼‰

ä½¿ç”¨Postmanè°ƒç”¨åˆ›å»ºæ¥å£æ¥æ·»åŠ æ•°æ®ï¼š

#### è¯·æ±‚ï¼š
```
POST http://127.0.0.1:8902/api/short-link/admin/v1/create
Content-Type: application/json
```

#### è¯·æ±‚ä½“ï¼š
```json
{
  "domain": "nurl.ink",
  "originUrl": "https://www.baidu.com",
  "gid": "15",
  "createdType": 0,
  "validDateType": 0,
  "describe": "æµ‹è¯•çŸ­é“¾æ¥"
}
```

---

## âœ… éªŒè¯æ­¥éª¤

### 1. ç¡®è®¤æ•°æ®å·²æ’å…¥
åœ¨æ•°æ®åº“æ‰§è¡Œï¼š
```sql
SELECT * FROM t_link WHERE gid = '15' AND del_flag = 0;
```

åº”è¯¥èƒ½çœ‹åˆ°æ•°æ®ã€‚

### 2. å†æ¬¡æµ‹è¯•åˆ†é¡µæ¥å£
åœ¨Postmanå‘é€ï¼š
```
GET http://127.0.0.1:8902/api/short-link/admin/v1/page?gid=15&current=1&size=10
```

### 3. é¢„æœŸç»“æœ
```json
{
  "code": "0",
  "message": null,
  "data": {
    "records": [
      {
        "id": 1,
        "domain": "nurl.ink",
        "shortUri": "abc123",
        "fullShortUrl": "nurl.ink/abc123",
        "originUrl": "https://www.baidu.com",
        "clickNum": 0,
        "gid": "15",
        "validDateType": 0,
        "validDate": null,
        "createTime": "2025-10-01 10:00:00",
        "describe": "æµ‹è¯•çŸ­é“¾æ¥-ç™¾åº¦",
        "favicon": null
      },
      // ... æ›´å¤šæ•°æ®
    ],
    "total": 3,
    "size": 10,
    "current": 1,
    "pages": 1
  },
  "requestId": null,
  "success": true
}
```

---

## ğŸ¯ å®Œæ•´æµ‹è¯•æµç¨‹

### ç¬¬1æ­¥ï¼šå‡†å¤‡æ•°æ®
```sql
-- åœ¨æ•°æ®åº“æ‰§è¡Œï¼Œåˆ›å»ºæµ‹è¯•æ•°æ®
-- å‚è€ƒä¸Šé¢çš„SQLè„šæœ¬
```

### ç¬¬2æ­¥ï¼šæµ‹è¯•åˆ›å»ºæ¥å£
```
POST http://127.0.0.1:8902/api/short-link/admin/v1/create

{
  "domain": "nurl.ink",
  "originUrl": "https://www.example.com",
  "gid": "15",
  "createdType": 0,
  "validDateType": 0,
  "describe": "æ–°åˆ›å»ºçš„çŸ­é“¾æ¥"
}
```

### ç¬¬3æ­¥ï¼šæµ‹è¯•åˆ†é¡µæŸ¥è¯¢
```
GET http://127.0.0.1:8902/api/short-link/admin/v1/page?gid=15&current=1&size=10
```

### ç¬¬4æ­¥ï¼šéªŒè¯æ•°æ®
ç¡®è®¤è¿”å›çš„dataä¸­æœ‰recordsæ•°æ®ã€‚

---

## ğŸ’¡ æ³¨æ„äº‹é¡¹

### 1. å…³äºgid
- gidæ˜¯åˆ†ç»„æ ‡è¯†ï¼Œéœ€è¦å…ˆåœ¨ `t_group` è¡¨ä¸­å­˜åœ¨
- æµ‹è¯•æ—¶ä½¿ç”¨ç»Ÿä¸€çš„gidï¼ˆå¦‚'15'ï¼‰

### 2. å…³äºåˆ†è¡¨
å¦‚æœä½¿ç”¨äº†ShardingSphereåˆ†è¡¨ï¼Œæ•°æ®å¯èƒ½åˆ†æ•£åœ¨ä¸åŒçš„è¡¨ä¸­ï¼š
- `t_link_0`
- `t_link_1`
- ...

å¯ä»¥æ‰§è¡Œï¼š
```sql
-- æŸ¥çœ‹æ‰€æœ‰åˆ†è¡¨çš„æ•°æ®
SELECT * FROM t_link_0 WHERE gid = '15';
SELECT * FROM t_link_1 WHERE gid = '15';
-- ... æ ¹æ®ä½ çš„åˆ†è¡¨æ•°é‡
```

### 3. å…³äºdel_flag
- `del_flag = 0` è¡¨ç¤ºæœªåˆ é™¤
- `del_flag = 1` è¡¨ç¤ºå·²åˆ é™¤
- æŸ¥è¯¢æ—¶è¦è¿‡æ»¤æ‰å·²åˆ é™¤çš„æ•°æ®

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ’å…¥æ•°æ®æ—¶æŠ¥é”™ "Duplicate entry"
**åŸå› **: æ•°æ®å·²å­˜åœ¨ï¼ˆgidé‡å¤æˆ–full_short_urlé‡å¤ï¼‰

**è§£å†³**:
```sql
-- å…ˆåˆ é™¤æ—§æ•°æ®
DELETE FROM t_group WHERE gid = '15';
DELETE FROM t_link WHERE gid = '15';
-- å†é‡æ–°æ’å…¥
```

### Q2: æŸ¥è¯¢è¿”å›dataè¿˜æ˜¯null
**æ£€æŸ¥æ¸…å•**:
- [ ] æ•°æ®ç¡®å®æ’å…¥æˆåŠŸäº†ï¼ˆSELECTéªŒè¯ï¼‰
- [ ] del_flag = 0ï¼ˆæœªåˆ é™¤ï¼‰
- [ ] gidåŒ¹é…
- [ ] å¦‚æœæœ‰åˆ†è¡¨ï¼Œæ£€æŸ¥æ‰€æœ‰åˆ†è¡¨

### Q3: æ¥å£è¿”å›ç©ºæ•°ç»„ records: []
**å¯èƒ½åŸå› **:
- æ•°æ®åœ¨å…¶ä»–åˆ†è¡¨ä¸­
- del_flag = 1ï¼ˆå·²åˆ é™¤ï¼‰
- gidä¸åŒ¹é…

---

## ğŸ“Š æ•°æ®åº“è¡¨å…³ç³»

```
t_group (åˆ†ç»„è¡¨)
  â†“ (ä¸€å¯¹å¤š)
t_link (çŸ­é“¾æ¥è¡¨)

å…³è”å­—æ®µ: gid
```

---

## ğŸ“ å­¦ä¹ å»ºè®®

1. **å…ˆæ‰‹åŠ¨æ’å…¥æµ‹è¯•æ•°æ®** - ç†è§£è¡¨ç»“æ„
2. **æµ‹è¯•æŸ¥è¯¢æ¥å£** - éªŒè¯æœåŠ¡é—´è°ƒç”¨
3. **æµ‹è¯•åˆ›å»ºæ¥å£** - å®Œæ•´çš„ä¸šåŠ¡æµç¨‹
4. **è§‚å¯Ÿåˆ†è¡¨æœºåˆ¶** - ç†è§£ShardingSphereå¦‚ä½•å·¥ä½œ

---

## âœ… æˆåŠŸæ ‡å¿—

å½“ä½ çœ‹åˆ°è¿™æ ·çš„è¿”å›ï¼Œå°±è¯´æ˜ä¸€åˆ‡æ­£å¸¸äº†ï¼š

```json
{
  "code": "0",
  "success": true,
  "data": {
    "records": [ /* æœ‰æ•°æ® */ ],
    "total": 3,
    "current": 1
  }
}
```

ğŸ‰ æ­å–œä½ ï¼Œè”è°ƒæˆåŠŸï¼ 