# è¿œç¨‹è°ƒç”¨å®ç°æ–¹æ¡ˆå¯¹æ¯”

## æ–¹æ¡ˆä¸€ï¼šæ•™å­¦è§†é¢‘æ–¹æ¡ˆï¼ˆæ¥å£defaultæ–¹æ³• + Hutoolï¼‰

### ä»£ç ç¤ºä¾‹
```java
public interface ShortLinkRemoteService {
    default Result<IPage<ShortLinkPageRespDTO>> pageShortLink(ShortLinkPageReqDTO requestParam) {
        Map<String, Object> requestMap = new HashMap<>();
        requestMap.put("gid", requestParam.getGid());
        requestMap.put("current", requestParam.getCurrent());
        requestMap.put("size", requestParam.getSize());
        String resultPageStr = HttpUtil.get("http://127.0.0.1:8001/api/short-link/v1/page", requestMap);
        return JSON.parseObject(resultPageStr, new TypeReference<>() {});
    }
}
```

### âœ… ä¼˜ç‚¹
1. **ä»£ç ç®€æ´** - åœ¨æ¥å£ä¸­ç›´æ¥å®ç°ï¼Œä»£ç é‡å°‘
2. **å­¦ä¹ æˆæœ¬ä½** - é€»è¾‘ç›´è§‚ï¼Œæ˜“äºç†è§£
3. **å¿«é€Ÿå®ç°** - é€‚åˆå¿«é€ŸåŸå‹å¼€å‘å’Œæ•™å­¦æ¼”ç¤º
4. **ä¾èµ–ç®€å•** - åªéœ€è¦Hutoolå·¥å…·ç±»

### âŒ ç¼ºç‚¹
1. **ç¡¬ç¼–ç URL** - `http://127.0.0.1:8001` å†™æ­»åœ¨ä»£ç ä¸­
   - æ— æ³•æ ¹æ®ç¯å¢ƒï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰åŠ¨æ€åˆ‡æ¢
   - ä¿®æ”¹URLéœ€è¦é‡æ–°ç¼–è¯‘ä»£ç 
   
2. **ä¸ç¬¦åˆSpringè§„èŒƒ** - æ²¡æœ‰ä½¿ç”¨Springçš„ä¾èµ–æ³¨å…¥
   - æ— æ³•åˆ©ç”¨Springçš„ç”Ÿæ€å’Œç‰¹æ€§
   - ä¸Spring Booté£æ ¼ä¸ä¸€è‡´
   
3. **éš¾ä»¥æµ‹è¯•** - æ— æ³•Mockå’Œå•å…ƒæµ‹è¯•
   - defaultæ–¹æ³•å†…éƒ¨é€»è¾‘æ— æ³•è¢«æ›¿æ¢
   - ä¸åˆ©äºTDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰
   
4. **é”™è¯¯å¤„ç†ä¸è¶³** - æ²¡æœ‰å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
   - è°ƒè¯•å›°éš¾
   - ç”Ÿäº§ç¯å¢ƒé—®é¢˜éš¾ä»¥æ’æŸ¥
   
5. **ä¸ä¾¿äºæ‰©å±•** - åç»­æ·»åŠ åŠŸèƒ½å›°éš¾
   - æ— æ³•æ·»åŠ æ‹¦æˆªå™¨ã€ç†”æ–­ã€é‡è¯•ç­‰
   - ä¸æ”¯æŒç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†
   
6. **è¿åè®¾è®¡åŸåˆ™**
   - æ¥å£åº”è¯¥å®šä¹‰å¥‘çº¦ï¼Œä¸åº”åŒ…å«å®ç°é€»è¾‘
   - è¿åäº†å•ä¸€èŒè´£åŸåˆ™

### ğŸ“ é€‚ç”¨åœºæ™¯
- æ•™å­¦æ¼”ç¤ºå’Œå¿«é€Ÿå­¦ä¹ 
- ä¸ªäººé¡¹ç›®æˆ–å°å‹demo
- ä¸´æ—¶æµ‹è¯•ä»£ç 
- å¯¹æ‰©å±•æ€§è¦æ±‚ä¸é«˜çš„ç®€å•åœºæ™¯

---

## æ–¹æ¡ˆäºŒï¼šä¼ä¸šçº§æ–¹æ¡ˆï¼ˆå•ç‹¬å®ç°ç±» + RestTemplateï¼‰

### ä»£ç ç¤ºä¾‹
```java
// æ¥å£å®šä¹‰
public interface ShortLinkRemoteService {
    Result<ShortLinkCreateRespDTO> createShortLink(ShortLinkCreateReqDTO requestParam);
    Result<IPage<ShortLinkPageRespDTO>> pageShortLink(ShortLinkPageReqDTO requestParam);
}

// å®ç°ç±»
@Slf4j
@Service
@RequiredArgsConstructor
public class ShortLinkRemoteServiceImpl implements ShortLinkRemoteService {
    
    private final RestTemplate restTemplate;
    
    @Value("${short-link.project.url:http://127.0.0.1:8001}")
    private String projectServiceUrl;
    
    @Override
    public Result<IPage<ShortLinkPageRespDTO>> pageShortLink(ShortLinkPageReqDTO requestParam) {
        String url = projectServiceUrl + "/api/short-link/v1/page?gid={gid}&current={current}&size={size}";
        
        Map<String, Object> params = new HashMap<>();
        params.put("gid", requestParam.getGid());
        params.put("current", requestParam.getCurrent());
        params.put("size", requestParam.getSize());
        
        try {
            String response = restTemplate.getForObject(url, String.class, params);
            return JSON.parseObject(response, new TypeReference<Result<IPage<ShortLinkPageRespDTO>>>() {});
        } catch (Exception e) {
            log.error("è¿œç¨‹è°ƒç”¨åˆ†é¡µæŸ¥è¯¢çŸ­é“¾æ¥å¤±è´¥", e);
            throw new RuntimeException("è¿œç¨‹è°ƒç”¨åˆ†é¡µæŸ¥è¯¢çŸ­é“¾æ¥å¤±è´¥: " + e.getMessage());
        }
    }
}
```

### é…ç½®æ–‡ä»¶
```yaml
# application.yaml
short-link:
  project:
    url: http://127.0.0.1:8001
```

### âœ… ä¼˜ç‚¹
1. **é…ç½®åŒ–ç®¡ç†** - URLé€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†
   - æ”¯æŒä¸åŒç¯å¢ƒé…ç½®ï¼ˆdev/test/prodï¼‰
   - æ— éœ€ä¿®æ”¹ä»£ç å³å¯åˆ‡æ¢ç¯å¢ƒ
   - æ”¯æŒé…ç½®ä¸­å¿ƒåŠ¨æ€åˆ·æ–°
   
2. **ç¬¦åˆSpringæœ€ä½³å®è·µ**
   - ä½¿ç”¨Springçš„RestTemplate
   - ä¾èµ–æ³¨å…¥ï¼Œç¬¦åˆIoCåŸåˆ™
   - ä¸Spring Bootç”Ÿæ€å®Œç¾é›†æˆ
   
3. **ä¾¿äºæµ‹è¯•** - æ”¯æŒMockå’Œå•å…ƒæµ‹è¯•
   ```java
   @MockBean
   private ShortLinkRemoteService shortLinkRemoteService;
   ```
   
4. **å®Œå–„çš„é”™è¯¯å¤„ç†**
   - try-catchæ•è·å¼‚å¸¸
   - æ—¥å¿—è®°å½•ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
   - å¯ä»¥æ·»åŠ ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†
   
5. **èŒè´£åˆ†ç¦»** - ç¬¦åˆSOLIDåŸåˆ™
   - æ¥å£å®šä¹‰å¥‘çº¦ï¼ˆWhatï¼‰
   - å®ç°ç±»è´Ÿè´£å…·ä½“é€»è¾‘ï¼ˆHowï¼‰
   - ä¾¿äºç†è§£å’Œç»´æŠ¤
   
6. **æ˜“äºæ‰©å±•**
   - å¯ä»¥æ·»åŠ å¤šä¸ªå®ç°ï¼ˆå¦‚Feignç‰ˆæœ¬ï¼‰
   - æ”¯æŒAOPåˆ‡é¢ç¼–ç¨‹
   - å¯ä»¥é›†æˆHystrixç†”æ–­ã€Retryé‡è¯•ç­‰
   - ä¾¿äºæ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨ã€è®¤è¯ç­‰
   
7. **å›¢é˜Ÿåä½œå‹å¥½**
   - æ¥å£å’Œå®ç°åˆ†ç¦»ï¼Œå¤šäººå¯å¹¶è¡Œå¼€å‘
   - ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºCode Review
   - ç¬¦åˆä¼ä¸šå¼€å‘è§„èŒƒ

### âŒ ç¼ºç‚¹
1. **ä»£ç é‡ç¨å¤š** - éœ€è¦é¢å¤–çš„å®ç°ç±»
2. **åˆå§‹å¼€å‘æ—¶é—´ç•¥é•¿** - éœ€è¦é…ç½®å¤šä¸ªæ–‡ä»¶

### ğŸ“ é€‚ç”¨åœºæ™¯
- ä¼ä¸šçº§é¡¹ç›®å¼€å‘
- éœ€è¦é•¿æœŸç»´æŠ¤çš„é¡¹ç›®
- å¤šäººåä½œçš„å›¢é˜Ÿé¡¹ç›®
- å¯¹æ‰©å±•æ€§ã€å¯æµ‹è¯•æ€§è¦æ±‚é«˜çš„åœºæ™¯
- å¾®æœåŠ¡æ¶æ„

---

## ğŸ¯ æ¨èå»ºè®®

### å¦‚æœä½ æ˜¯ï¼š

#### ğŸ“š **æ­£åœ¨å­¦ä¹ é˜¶æ®µ**
â†’ **å»ºè®®ä½¿ç”¨æ•™å­¦è§†é¢‘æ–¹æ¡ˆ**
- å¿«é€Ÿç†è§£HTTPè°ƒç”¨åŸç†
- ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘å­¦ä¹ 
- å‡å°‘å¤æ‚åº¦ï¼Œé™ä½å­¦ä¹ é—¨æ§›

#### ğŸ’¼ **è¿›è¡Œä¼ä¸šé¡¹ç›®å¼€å‘**
â†’ **å¼ºçƒˆæ¨èä¼ä¸šçº§æ–¹æ¡ˆ**
- ç¬¦åˆå·¥ä¸šç•Œæ ‡å‡†å’Œæœ€ä½³å®è·µ
- ä¾¿äºåç»­ç»´æŠ¤å’Œæ‰©å±•
- é¢è¯•å’Œå®é™…å·¥ä½œä¸­çš„åŠ åˆ†é¡¹

#### ğŸ”„ **ä»å­¦ä¹ åˆ°å·¥ä½œè¿‡æ¸¡**
â†’ **å»ºè®®æŒæ¡ä¸¤ç§æ–¹æ¡ˆ**
- ç†è§£æ•™å­¦æ–¹æ¡ˆçš„ç®€æ´æ€§
- æŒæ¡ä¼ä¸šæ–¹æ¡ˆçš„è®¾è®¡æ€æƒ³
- æ ¹æ®å®é™…åœºæ™¯é€‰æ‹©åˆé€‚æ–¹æ¡ˆ

---

## ğŸ”§ å¦‚ä½•é€‰æ‹©ï¼Ÿ

| å¯¹æ¯”ç»´åº¦ | æ•™å­¦è§†é¢‘æ–¹æ¡ˆ | ä¼ä¸šçº§æ–¹æ¡ˆ |
|---------|------------|----------|
| ä»£ç ç®€æ´åº¦ | â­â­â­â­â­ | â­â­â­ |
| å­¦ä¹ æˆæœ¬ | â­â­â­â­â­ | â­â­â­ |
| å¯ç»´æŠ¤æ€§ | â­â­ | â­â­â­â­â­ |
| å¯æµ‹è¯•æ€§ | â­ | â­â­â­â­â­ |
| å¯æ‰©å±•æ€§ | â­â­ | â­â­â­â­â­ |
| Springé›†æˆ | â­â­ | â­â­â­â­â­ |
| é…ç½®çµæ´»æ€§ | â­ | â­â­â­â­â­ |
| é”™è¯¯å¤„ç† | â­â­ | â­â­â­â­â­ |
| å›¢é˜Ÿåä½œ | â­â­ | â­â­â­â­â­ |
| ä¼ä¸šè®¤å¯åº¦ | â­â­ | â­â­â­â­â­ |

---

## ğŸ’¡ è¿›é˜¶æ–¹æ¡ˆï¼šSpring Cloud OpenFeign

å¦‚æœé¡¹ç›®åç»­å‘å±•ä¸ºå¾®æœåŠ¡æ¶æ„ï¼Œæ¨èä½¿ç”¨ **OpenFeign**ï¼š

```java
@FeignClient(name = "short-link-project", url = "${short-link.project.url}")
public interface ShortLinkRemoteService {
    
    @PostMapping("/api/short-link/v1/create")
    Result<ShortLinkCreateRespDTO> createShortLink(@RequestBody ShortLinkCreateReqDTO requestParam);
    
    @GetMapping("/api/short-link/v1/page")
    Result<IPage<ShortLinkPageRespDTO>> pageShortLink(@SpringQueryMap ShortLinkPageReqDTO requestParam);
}
```

### OpenFeignçš„ä¼˜åŠ¿
- å£°æ˜å¼HTTPå®¢æˆ·ç«¯ï¼Œä»£ç æœ€ç®€æ´
- å®Œç¾é›†æˆSpring Cloud
- è‡ªåŠ¨è´Ÿè½½å‡è¡¡
- æ”¯æŒç†”æ–­é™çº§ï¼ˆHystrix/Sentinelï¼‰
- ä¼ä¸šå¾®æœåŠ¡æ ‡å‡†æ–¹æ¡ˆ

---

## ğŸ“Œ æ€»ç»“

1. **å­¦ä¹ é˜¶æ®µ**ï¼šæ•™å­¦è§†é¢‘æ–¹æ¡ˆå¤Ÿç”¨ï¼Œä¸“æ³¨ç†è§£åŸç†
2. **ç®€å†é¡¹ç›®**ï¼šä½¿ç”¨ä¼ä¸šçº§æ–¹æ¡ˆï¼Œå±•ç°ä¸“ä¸šæ€§
3. **å®é™…å·¥ä½œ**ï¼šæ ¹æ®å…¬å¸æŠ€æœ¯æ ˆé€‰æ‹©ï¼ˆé€šå¸¸æ˜¯RestTemplateæˆ–Feignï¼‰
4. **ä¸ªäººæˆé•¿**ï¼šå»ºè®®ä¸‰ç§æ–¹æ¡ˆéƒ½æŒæ¡ï¼Œç†è§£å„è‡ªçš„é€‚ç”¨åœºæ™¯

**æˆ‘çš„å»ºè®®**ï¼šæ—¢ç„¶ä½ ç°åœ¨å·²ç»æœ‰äº†ä¼ä¸šçº§æ–¹æ¡ˆçš„ä»£ç ï¼Œå°±ç»§ç»­ä½¿ç”¨å®ƒå§ï¼è¿™å¯¹ä½ æœªæ¥çš„èŒä¸šå‘å±•æ›´æœ‰å¸®åŠ©ã€‚æ•™å­¦è§†é¢‘çš„æ–¹æ¡ˆå¯ä»¥ä½œä¸ºç†è§£å‚è€ƒã€‚ 